{"ast":null,"code":"var _jsxFileName = \"/Users/tim/Documents/RCM_taskManage/src/InputFile.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass InputFile extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.getExcel = excel => {\n      //8碼日期y+m+d\n      let date = new Date();\n      var y = date.getFullYear().toString();\n      var m = (date.getMonth() + 1).toString();\n\n      if (m < 10) {\n        m = \"0\" + m;\n      }\n\n      var d = date.getDate().toString();\n\n      if (d < 10) {\n        d = \"0\" + d;\n      } //欄位資料的建構式\n\n\n      function MachineInfo(index, taskId, produceBatchNo, productModelNo, currentQuantity, machinePosition) {\n        return {\n          index: index,\n          taskId: taskId,\n          produceBatchNo: produceBatchNo,\n          productModelNo: productModelNo,\n          currentQuantity: currentQuantity,\n          machinePosition: machinePosition,\n          key: '',\n          action: '',\n          currentStatus: '未派工',\n          eRackPositionNotTested: '',\n          eRackPositionTested: '',\n          pv: '50'\n        };\n      } //迴圈取資料\n\n\n      var data = [];\n      var i = 0,\n          j,\n          k;\n      var m_index = 0;\n      var m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition;\n\n      for (; excel.length > i; ++i) {\n        if (excel[i].hasOwnProperty('矽格股份有限公司')) {\n          if (excel[i]['矽格股份有限公司'].hasOwnProperty('length')) {\n            if (excel[i]['矽格股份有限公司'].indexOf('DX-') > -1) {\n              m_machinePosition = excel[i]['矽格股份有限公司'];\n\n              for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2'); ++j, ++k) {\n                m_taskId = y + m + d + excel[j].__EMPTY_2;\n                m_produceBatchNo = excel[j].__EMPTY_2;\n                m_productModelNo = excel[j].__EMPTY_4;\n                m_currentQuantity = excel[j].__EMPTY_7;\n                data[m_index] = MachineInfo(m_index, m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition);\n                ++m_index;\n              }\n\n              if (excel[i].hasOwnProperty('__EMPTY_12')) {\n                m_machinePosition = excel[i].__EMPTY_12;\n\n                for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15'); ++j, ++k) {\n                  m_taskId = y + m + d + excel[j].__EMPTY_15;\n                  m_produceBatchNo = excel[j].__EMPTY_15;\n                  m_productModelNo = excel[j].__EMPTY_17;\n                  m_currentQuantity = excel[j].__EMPTY_20;\n                  data[m_index] = MachineInfo(m_index, m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition);\n                  ++m_index;\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return data;\n    };\n\n    this.onImportExcel = files => {\n      const fileReader = new FileReader();\n\n      for (let index = 0; index < files.length; index++) fileReader.name = files[index].name;\n\n      fileReader.onload = event => {\n        try {\n          const fileExt = event.target.name;\n          if (fileExt == null) throw RangeError(\"檔案為空值\");\n          const {\n            result\n          } = event.target;\n          const workbook = XLSX.read(result, {\n            type: \"binary\"\n          });\n          let excel = [];\n          excel = excel.concat(XLSX.utils.sheet_to_json(workbook.Sheets['DX']));\n          console.log(excel); //array 461筆\n          //\n\n          var exceldata = this.getExcel(excel);\n          console.log(exceldata); //array 300筆\n\n          return exceldata; // ReactDOM.render(\n          //     <div></div>, \n          //     document.getElementById('root'));\n          // ReactDOM.render(\n          //     <div>\n          //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n          //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n          //         </InputFiles>\n          //         <ManuallyCreate name=\"手動新增\" />\n          //         <SortableTable data={exceldata} />\n          //     </div>, \n          //     document.getElementById('root'));\n        } catch (e) {\n          alert(e);\n          return;\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      children: /*#__PURE__*/_jsxDEV(InputFiles, {\n        accept: this.props.accept,\n        onChange: this.onImportExcel,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"extractButton\",\n          type: \"primary\",\n          children: this.props.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default InputFile;","map":{"version":3,"sources":["/Users/tim/Documents/RCM_taskManage/src/InputFile.js"],"names":["React","ReactDOM","InputFiles","XLSX","SortableTable","ManuallyCreate","Button","InputFile","Component","getExcel","excel","date","Date","y","getFullYear","toString","m","getMonth","d","getDate","MachineInfo","index","taskId","produceBatchNo","productModelNo","currentQuantity","machinePosition","key","action","currentStatus","eRackPositionNotTested","eRackPositionTested","pv","data","i","j","k","m_index","m_taskId","m_produceBatchNo","m_productModelNo","m_currentQuantity","m_machinePosition","length","hasOwnProperty","indexOf","__EMPTY_2","__EMPTY_4","__EMPTY_7","__EMPTY_12","__EMPTY_15","__EMPTY_17","__EMPTY_20","onImportExcel","files","fileReader","FileReader","name","onload","event","fileExt","target","RangeError","result","workbook","read","type","concat","utils","sheet_to_json","Sheets","console","log","exceldata","e","alert","readAsBinaryString","render","props","accept"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\n\n\nclass InputFile extends React.Component{\n    getExcel = (excel) => {\n        //8碼日期y+m+d\n\t\tlet date = new Date();\n\t\tvar y = date.getFullYear().toString();\n\t\tvar m = (date.getMonth()+1).toString();\n\t\t\tif(m < 10){\n\t\t\t\tm = \"0\" + m;\n\t\t\t}\n\t\tvar d = date.getDate().toString();\n            if (d < 10){\n                d = \"0\" + d ;\n            }\n        //欄位資料的建構式\n        function MachineInfo(index,taskId,produceBatchNo,productModelNo,currentQuantity,machinePosition){\n            return{\n                index : index,\n                taskId : taskId,\n                produceBatchNo : produceBatchNo,\n                productModelNo : productModelNo,\n                currentQuantity : currentQuantity,\n                machinePosition : machinePosition,\n                key : '',\n                action : '',\n                currentStatus : '未派工',\n                eRackPositionNotTested : '',\n                eRackPositionTested : '',\n                pv : '50'\n            };\n        }\n        //迴圈取資料\n        var data = [];\n\t\tvar i = 0,j,k;\n        var m_index = 0;\n        var m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition;\n\t\tfor(;excel.length > i; ++i){\n\t\t\tif(excel[i].hasOwnProperty('矽格股份有限公司')){\n\t\t\t\tif(excel[i]['矽格股份有限公司'].hasOwnProperty('length')){  \n\t\t\t\t\tif(excel[i]['矽格股份有限公司'].indexOf('DX-') > -1){\n\t\t\t\t\t\tm_machinePosition = excel[i]['矽格股份有限公司'];\n\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2');++j,++k){\n\t\t\t\t\t\t\tm_taskId =  y + m + d + excel[j].__EMPTY_2;\n\t\t\t\t\t\t\tm_produceBatchNo = excel[j].__EMPTY_2;\n\t\t\t\t\t\t\tm_productModelNo = excel[j].__EMPTY_4;\n\t\t\t\t\t\t\tm_currentQuantity = excel[j].__EMPTY_7;\n\t\t\t\t\t\t\tdata[m_index] = MachineInfo(m_index,m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition);\n\t\t\t\t\t\t\t++m_index;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(excel[i].hasOwnProperty('__EMPTY_12')){\n\t\t\t\t\t\t\tm_machinePosition = excel[i].__EMPTY_12;\n\t\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15');++j,++k){\n\t\t\t\t\t\t\t\tm_taskId =  y + m + d + excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\tm_produceBatchNo = excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\tm_productModelNo = excel[j].__EMPTY_17;\n\t\t\t\t\t\t\t\tm_currentQuantity = excel[j].__EMPTY_20;\n\t\t\t\t\t\t\t\tdata[m_index] = MachineInfo(m_index,m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition);\n\t\t\t\t\t\t\t\t++m_index;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n    onImportExcel = files => {\n        const fileReader = new FileReader();\n        for (let index = 0; index < files.length; index++)\n            fileReader.name = files[index].name;\n        fileReader.onload = event => {\n            try {\n                const fileExt = event.target.name;\n                if (fileExt == null)\n                    throw RangeError(\"檔案為空值\");\n                const { result } = event.target;\n                const workbook = XLSX.read(result, { type: \"binary\" });\n                let excel = [];\n                excel = excel.concat(\n                    XLSX.utils.sheet_to_json(workbook.Sheets['DX'])\n                );\n                console.log(excel); //array 461筆\n                //\n                var exceldata = this.getExcel(excel);\n                console.log(exceldata); //array 300筆\n                return exceldata;\n                // ReactDOM.render(\n                //     <div></div>, \n                //     document.getElementById('root'));\n                // ReactDOM.render(\n                //     <div>\n                //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n                //         </InputFiles>\n                //         <ManuallyCreate name=\"手動新增\" />\n                //         <SortableTable data={exceldata} />\n                //     </div>, \n                //     document.getElementById('root'));\n            } catch (e) {\n                alert(e);\n                return;\n            }\n        };\n        fileReader.readAsBinaryString(files[0]);\n    };\n    render(){\n        return (\n            <span>\n                <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                    <Button className=\"extractButton\" type=\"primary\">\n                        {this.props.name}\n                    </Button>\n                </InputFiles>\n            </span>\n        );\n    };\n}\nexport default InputFile;"]},"metadata":{},"sourceType":"module"}