{"ast":null,"code":"var _jsxFileName = \"/Users/tim/Documents/React/React_test/src/InputFile.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport * as script from './Script.js';\nimport './index.css';\nimport ManuallyEdit from './ManuallyEdit';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DragHandle = sortableHandle(_c = () => /*#__PURE__*/_jsxDEV(MenuOutlined, {\n  style: {\n    cursor: 'grab',\n    color: '#999'\n  }\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 12,\n  columnNumber: 41\n}, this));\n_c2 = DragHandle;\n\nclass InputFile extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.onImportExcel = files => {\n      const fileReader = new FileReader();\n\n      for (let index = 0; index < files.length; index++) fileReader.name = files[index].name;\n\n      fileReader.onload = event => {\n        try {\n          const fileExt = event.target.name;\n          if (fileExt == null) throw RangeError(\"檔案為空值\");\n          const {\n            result\n          } = event.target;\n          const workbook = XLSX.read(result, {\n            type: \"binary\"\n          });\n          let excel = [];\n          excel = excel.concat(XLSX.utils.sheet_to_json(workbook.Sheets['DX']));\n          var exceldata = script.getExcel(excel);\n          var metadata = script.getMetadate();\n          ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 33,\n            columnNumber: 21\n          }, this), document.getElementById('root'));\n          ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(InputFiles, {\n              accept: this.props.accept,\n              onChange: this.onImportExcel,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                className: \"extractButton\",\n                children: this.props.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 39,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 38,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(SortableTable, {\n              columns: metadata,\n              data: exceldata\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 42,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 21\n          }, this), document.getElementById('root'));\n        } catch (e) {\n          alert(e);\n          return;\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      children: /*#__PURE__*/_jsxDEV(InputFiles, {\n        accept: this.props.accept,\n        onChange: this.onImportExcel,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"extractButton\",\n          type: \"primary\",\n          children: this.props.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default InputFile;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"DragHandle$sortableHandle\");\n$RefreshReg$(_c2, \"DragHandle\");","map":{"version":3,"sources":["/Users/tim/Documents/React/React_test/src/InputFile.js"],"names":["React","ReactDOM","InputFiles","XLSX","SortableTable","script","ManuallyEdit","ManuallyCreate","Button","DragHandle","sortableHandle","cursor","color","InputFile","Component","onImportExcel","files","fileReader","FileReader","index","length","name","onload","event","fileExt","target","RangeError","result","workbook","read","type","excel","concat","utils","sheet_to_json","Sheets","exceldata","getExcel","metadata","getMetadate","render","document","getElementById","props","accept","e","alert","readAsBinaryString"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport * as script from './Script.js';\nimport './index.css';\nimport ManuallyEdit from './ManuallyEdit';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\n\nconst DragHandle = sortableHandle(() => <MenuOutlined style={{ cursor: 'grab', color: '#999' }} />);\n\nclass InputFile extends React.Component{\n    onImportExcel = files => {\n        const fileReader = new FileReader();\n        for (let index = 0; index < files.length; index++)\n            fileReader.name = files[index].name;\n        fileReader.onload = event => {\n            try {\n                const fileExt = event.target.name;\n                if (fileExt == null)\n                    throw RangeError(\"檔案為空值\");\n                const { result } = event.target;\n                const workbook = XLSX.read(result, { type: \"binary\" });\n                let excel = [];\n                excel = excel.concat(\n                    XLSX.utils.sheet_to_json(workbook.Sheets['DX'])\n                );\n                var exceldata = script.getExcel(excel);\n                var metadata = script.getMetadate();\n                ReactDOM.render(\n                    <div>\n                    </div>, \n                    document.getElementById('root'));\n                ReactDOM.render(\n                    <div>\n                        <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                            <Button className=\"extractButton\">{this.props.name}</Button>\n                        </InputFiles>\n                        {/* <ManuallyCreate name=\"手動新增\" /> */}\n                        <SortableTable columns={metadata} data={exceldata} />\n                    </div>, \n                    document.getElementById('root'));\n            } catch (e) {\n                alert(e);\n                return;\n            }\n        };\n        fileReader.readAsBinaryString(files[0]);\n    };\n    render(){\n        return (\n            <span>\n                <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                    <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n                </InputFiles>\n            </span>\n        );\n    };\n}\nexport default InputFile;"]},"metadata":{},"sourceType":"module"}