{"ast":null,"code":"class MachineInfo {\n  constructor(index, taskId, produceBatchNo, productModelNo, currentQuantity, machinePosition) {\n    this.key = '';\n    this.action = '';\n    this.currentStatus = '';\n    this.eRackPositionNotTested = '';\n    this.eRackPositionTested = '';\n    this.vp = '50';\n    this.index = index;\n    this.taskId = taskId;\n    this.produceBatchNo = produceBatchNo;\n    this.productModelNo = productModelNo;\n    this.currentQuantity = currentQuantity;\n    this.machinePosition = machinePosition;\n  }\n\n}\n\nclass Metadata {\n  constructor(title, dataIndex, className) {\n    this.title = title;\n    this.dataIndex = dataIndex;\n    this.className = className;\n  }\n\n}\n\nexport function getExcel(excel) {\n  var data = [];\n  let date = new Date();\n  var y = date.getFullYear().toString();\n  var m = (date.getMonth() + 1).toString();\n\n  if (date.getMonth() + 1 < 10) {\n    m = \"0\" + m;\n  }\n\n  var d = date.getDate().toString();\n\n  if (date.getDate() < 10) {\n    d = \"0\" + d;\n  }\n\n  var i = 0,\n      j,\n      k,\n      count = 0,\n      task_id,\n      batchNo,\n      type,\n      num,\n      machine_position;\n\n  for (; excel.length > i; ++i) {\n    if (excel[i].hasOwnProperty('矽格股份有限公司')) {\n      if (excel[i]['矽格股份有限公司'].hasOwnProperty('length')) {\n        if (excel[i]['矽格股份有限公司'].indexOf('DX-') > -1) {\n          machine_position = excel[i]['矽格股份有限公司'];\n\n          for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2'); ++j, ++k) {\n            task_id = y + m + d + excel[j].__EMPTY_2;\n            batchNo = excel[j].__EMPTY_2;\n            type = excel[j].__EMPTY_4;\n            num = excel[j].__EMPTY_7;\n            data[count] = new MachineInfo(count, task_id, batchNo, type, num, machine_position);\n            ++count;\n          }\n\n          if (excel[i].hasOwnProperty('__EMPTY_12')) {\n            machine_position = excel[i].__EMPTY_12;\n\n            for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15'); ++j, ++k) {\n              task_id = y + m + d + excel[j].__EMPTY_15;\n              batchNo = excel[j].__EMPTY_15;\n              type = excel[j].__EMPTY_17;\n              num = excel[j].__EMPTY_20;\n              data[count] = new MachineInfo(count, task_id, batchNo, type, num, machine_position);\n              ++count;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return data;\n}\nexport function getMetadate() {\n  var data = [];\n  data.push(new Metadata('拖拉', 'sort', 'drag-visible'));\n  data.push(new Metadata('任務編號', 'taskId', 'drag-visible'));\n  data.push(new Metadata('生產批號', 'produceBatchNo'));\n  data.push(new Metadata('產品型號', 'productModelNo'));\n  data.push(new Metadata('現況數量', 'currentQuantity'));\n  data.push(new Metadata('機台位置', 'machinePosition'));\n  data.push(new Metadata('操作', 'action'));\n  data.push(new Metadata('派工狀態', 'currentStatus'));\n  data.push(new Metadata('e-Rack櫃位(待測)', 'eRackPositionNotTested'));\n  data.push(new Metadata('e-Rack櫃位(已測)', 'eRackPositionTested'));\n  data.push(new Metadata('優先序', 'vp'));\n  return data;\n}","map":{"version":3,"sources":["/Users/tim/Documents/React/React_test/src/Script.js"],"names":["MachineInfo","constructor","index","taskId","produceBatchNo","productModelNo","currentQuantity","machinePosition","key","action","currentStatus","eRackPositionNotTested","eRackPositionTested","vp","Metadata","title","dataIndex","className","getExcel","excel","data","date","Date","y","getFullYear","toString","m","getMonth","d","getDate","i","j","k","count","task_id","batchNo","type","num","machine_position","length","hasOwnProperty","indexOf","__EMPTY_2","__EMPTY_4","__EMPTY_7","__EMPTY_12","__EMPTY_15","__EMPTY_17","__EMPTY_20","getMetadate","push"],"mappings":"AAAA,MAAMA,WAAN,CAAiB;AACbC,EAAAA,WAAW,CAACC,KAAD,EAAOC,MAAP,EAAcC,cAAd,EAA6BC,cAA7B,EAA4CC,eAA5C,EAA4DC,eAA5D,EAA4E;AAAA,SAQvFC,GARuF,GAQjF,EARiF;AAAA,SASvFC,MATuF,GAS9E,EAT8E;AAAA,SAUvFC,aAVuF,GAUvE,EAVuE;AAAA,SAWvFC,sBAXuF,GAW9D,EAX8D;AAAA,SAYvFC,mBAZuF,GAYjE,EAZiE;AAAA,SAavFC,EAbuF,GAanF,IAbmF;AACrF,SAAKX,KAAL,GAAaA,KAAb;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,cAAL,GAAsBA,cAAtB;AACA,SAAKC,cAAL,GAAsBA,cAAtB;AACA,SAAKC,eAAL,GAAuBA,eAAvB;AACA,SAAKC,eAAL,GAAuBA,eAAvB;AACD;;AARY;;AAgBjB,MAAMO,QAAN,CAAc;AACbb,EAAAA,WAAW,CAACc,KAAD,EAAOC,SAAP,EAAiBC,SAAjB,EAA2B;AACrC,SAAKF,KAAL,GAAaA,KAAb;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACA;;AALY;;AAOd,OAAO,SAASC,QAAT,CAAkBC,KAAlB,EAAwB;AAC3B,MAAIC,IAAI,GAAG,EAAX;AACA,MAAIC,IAAI,GAAG,IAAIC,IAAJ,EAAX;AACA,MAAIC,CAAC,GAAGF,IAAI,CAACG,WAAL,GAAmBC,QAAnB,EAAR;AACA,MAAIC,CAAC,GAAG,CAACL,IAAI,CAACM,QAAL,KAAgB,CAAjB,EAAoBF,QAApB,EAAR;;AACI,MAAIJ,IAAI,CAACM,QAAL,KAAgB,CAAhB,GAAmB,EAAvB,EAA0B;AACtBD,IAAAA,CAAC,GAAG,MAAMA,CAAV;AACH;;AACL,MAAIE,CAAC,GAAGP,IAAI,CAACQ,OAAL,GAAeJ,QAAf,EAAR;;AACI,MAAIJ,IAAI,CAACQ,OAAL,KAAgB,EAApB,EAAuB;AACnBD,IAAAA,CAAC,GAAG,MAAMA,CAAV;AACH;;AACL,MAAIE,CAAC,GAAG,CAAR;AAAA,MAAUC,CAAV;AAAA,MAAYC,CAAZ;AAAA,MAAcC,KAAK,GAAG,CAAtB;AAAA,MAAwBC,OAAxB;AAAA,MAAgCC,OAAhC;AAAA,MAAwCC,IAAxC;AAAA,MAA6CC,GAA7C;AAAA,MAAiDC,gBAAjD;;AACA,SAAKnB,KAAK,CAACoB,MAAN,GAAeT,CAApB,EAAuB,EAAEA,CAAzB,EAA2B;AACvB,QAAGX,KAAK,CAACW,CAAD,CAAL,CAASU,cAAT,CAAwB,UAAxB,CAAH,EAAuC;AACnC,UAAGrB,KAAK,CAACW,CAAD,CAAL,CAAS,UAAT,EAAqBU,cAArB,CAAoC,QAApC,CAAH,EAAiD;AAC7C,YAAGrB,KAAK,CAACW,CAAD,CAAL,CAAS,UAAT,EAAqBW,OAArB,CAA6B,KAA7B,IAAsC,CAAC,CAA1C,EAA4C;AACxCH,UAAAA,gBAAgB,GAAGnB,KAAK,CAACW,CAAD,CAAL,CAAS,UAAT,CAAnB;;AACA,eAAIC,CAAC,GAAGD,CAAC,GAAG,CAAR,EAAUE,CAAC,GAAG,CAAlB,EAAoB,IAAIA,CAAJ,IAASb,KAAK,CAACoB,MAAN,GAAeR,CAAxB,IAA6BZ,KAAK,CAACY,CAAD,CAAL,CAASS,cAAT,CAAwB,WAAxB,CAAjD,EAAsF,EAAET,CAAF,EAAI,EAAEC,CAA5F,EAA8F;AAC1FE,YAAAA,OAAO,GAAIX,CAAC,GAAGG,CAAJ,GAAQE,CAAR,GAAYT,KAAK,CAACY,CAAD,CAAL,CAASW,SAAhC;AACAP,YAAAA,OAAO,GAAGhB,KAAK,CAACY,CAAD,CAAL,CAASW,SAAnB;AACAN,YAAAA,IAAI,GAAGjB,KAAK,CAACY,CAAD,CAAL,CAASY,SAAhB;AACAN,YAAAA,GAAG,GAAGlB,KAAK,CAACY,CAAD,CAAL,CAASa,SAAf;AACAxB,YAAAA,IAAI,CAACa,KAAD,CAAJ,GAAc,IAAIjC,WAAJ,CAAgBiC,KAAhB,EAAsBC,OAAtB,EAA8BC,OAA9B,EAAsCC,IAAtC,EAA2CC,GAA3C,EAA+CC,gBAA/C,CAAd;AACA,cAAEL,KAAF;AACH;;AACD,cAAGd,KAAK,CAACW,CAAD,CAAL,CAASU,cAAT,CAAwB,YAAxB,CAAH,EAAyC;AACrCF,YAAAA,gBAAgB,GAAGnB,KAAK,CAACW,CAAD,CAAL,CAASe,UAA5B;;AACA,iBAAId,CAAC,GAAGD,CAAC,GAAG,CAAR,EAAUE,CAAC,GAAG,CAAlB,EAAoB,IAAIA,CAAJ,IAASb,KAAK,CAACoB,MAAN,GAAeR,CAAxB,IAA6BZ,KAAK,CAACY,CAAD,CAAL,CAASS,cAAT,CAAwB,YAAxB,CAAjD,EAAuF,EAAET,CAAF,EAAI,EAAEC,CAA7F,EAA+F;AAC3FE,cAAAA,OAAO,GAAIX,CAAC,GAAGG,CAAJ,GAAQE,CAAR,GAAYT,KAAK,CAACY,CAAD,CAAL,CAASe,UAAhC;AACAX,cAAAA,OAAO,GAAGhB,KAAK,CAACY,CAAD,CAAL,CAASe,UAAnB;AACAV,cAAAA,IAAI,GAAGjB,KAAK,CAACY,CAAD,CAAL,CAASgB,UAAhB;AACAV,cAAAA,GAAG,GAAGlB,KAAK,CAACY,CAAD,CAAL,CAASiB,UAAf;AACA5B,cAAAA,IAAI,CAACa,KAAD,CAAJ,GAAc,IAAIjC,WAAJ,CAAgBiC,KAAhB,EAAsBC,OAAtB,EAA8BC,OAA9B,EAAsCC,IAAtC,EAA2CC,GAA3C,EAA+CC,gBAA/C,CAAd;AACA,gBAAEL,KAAF;AACH;AACJ;AACJ;AACJ;AACJ;AACJ;;AACD,SAAOb,IAAP;AACH;AACD,OAAO,SAAS6B,WAAT,GAAsB;AAC5B,MAAI7B,IAAI,GAAG,EAAX;AACAA,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,IAAb,EAAkB,MAAlB,EAAyB,cAAzB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,QAApB,EAA6B,cAA7B,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,gBAApB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,gBAApB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,iBAApB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,iBAApB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,IAAb,EAAkB,QAAlB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,MAAb,EAAoB,eAApB,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,cAAb,EAA4B,wBAA5B,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,cAAb,EAA4B,qBAA5B,CAAV;AACAM,EAAAA,IAAI,CAAC8B,IAAL,CAAU,IAAIpC,QAAJ,CAAa,KAAb,EAAmB,IAAnB,CAAV;AACA,SAAOM,IAAP;AACA","sourcesContent":["class MachineInfo{\n    constructor(index,taskId,produceBatchNo,productModelNo,currentQuantity,machinePosition){\n      this.index = index;\n      this.taskId = taskId;\n      this.produceBatchNo = produceBatchNo;\n      this.productModelNo = productModelNo;\n      this.currentQuantity = currentQuantity;\n      this.machinePosition = machinePosition;\n    }\n    key = '';\n    action = '';\n    currentStatus = '';\n    eRackPositionNotTested = '';\n    eRackPositionTested = '';\n    vp= '50';\n  }\nclass Metadata{\n\tconstructor(title,dataIndex,className){\n\t\tthis.title = title;\n\t\tthis.dataIndex = dataIndex;\n\t\tthis.className = className;\n\t}\n}\nexport function getExcel(excel){\n    var data = [];\n    let date = new Date();\n    var y = date.getFullYear().toString();\n    var m = (date.getMonth()+1).toString();\n        if( date.getMonth()+1 <10){\n            m = \"0\" + m;\n        }\n    var d = date.getDate().toString();\n        if( date.getDate() <10){\n            d = \"0\" + d;\n        }\n    var i = 0,j,k,count = 0,task_id,batchNo,type,num,machine_position;\n    for(;excel.length > i; ++i){\n        if(excel[i].hasOwnProperty('矽格股份有限公司')){\n            if(excel[i]['矽格股份有限公司'].hasOwnProperty('length')){  \n                if(excel[i]['矽格股份有限公司'].indexOf('DX-') > -1){\n                    machine_position = excel[i]['矽格股份有限公司'];\n                    for(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2');++j,++k){\n                        task_id =  y + m + d + excel[j].__EMPTY_2;\n                        batchNo = excel[j].__EMPTY_2;\n                        type = excel[j].__EMPTY_4;\n                        num = excel[j].__EMPTY_7;\n                        data[count] = new MachineInfo(count,task_id,batchNo,type,num,machine_position);\n                        ++count;\n                    }\n                    if(excel[i].hasOwnProperty('__EMPTY_12')){\n                        machine_position = excel[i].__EMPTY_12;\n                        for(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15');++j,++k){\n                            task_id =  y + m + d + excel[j].__EMPTY_15;\n                            batchNo = excel[j].__EMPTY_15;\n                            type = excel[j].__EMPTY_17;\n                            num = excel[j].__EMPTY_20;\n                            data[count] = new MachineInfo(count,task_id,batchNo,type,num,machine_position);\n                            ++count;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return data;\n}\nexport function getMetadate(){\n\tvar data = [];\n\tdata.push(new Metadata('拖拉','sort','drag-visible'));\n\tdata.push(new Metadata('任務編號','taskId','drag-visible'));\n\tdata.push(new Metadata('生產批號','produceBatchNo'));\n\tdata.push(new Metadata('產品型號','productModelNo'));\n\tdata.push(new Metadata('現況數量','currentQuantity'));\n\tdata.push(new Metadata('機台位置','machinePosition'));\n\tdata.push(new Metadata('操作','action'));\n\tdata.push(new Metadata('派工狀態','currentStatus'));\n\tdata.push(new Metadata('e-Rack櫃位(待測)','eRackPositionNotTested'));\n\tdata.push(new Metadata('e-Rack櫃位(已測)','eRackPositionTested'));\n\tdata.push(new Metadata('優先序','vp'));\n\treturn data;\n}\n\n\n"]},"metadata":{},"sourceType":"module"}