{"ast":null,"code":"var _jsxFileName = \"/Users/tim/Documents/React/React_test/src/InputFile.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport * as script from './Script.js';\nimport './index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass InputFile extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.onImportExcel = files => {\n      const fileReader = new FileReader();\n\n      for (let index = 0; index < files.length; index++) fileReader.name = files[index].name;\n\n      fileReader.onload = event => {\n        try {\n          const fileExt = event.target.name;\n          if (fileExt == null) throw RangeError(\"檔案為空值\");\n          const {\n            result\n          } = event.target;\n          const workbook = XLSX.read(result, {\n            type: \"binary\"\n          });\n          let excel = [];\n          excel = excel.concat(XLSX.utils.sheet_to_json(workbook.Sheets['DX']));\n          var exceldata = script.getExcel(excel);\n          var metadata = script.getMetadate();\n          ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 28,\n            columnNumber: 21\n          }, this), document.getElementById('root'));\n          ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(InputFiles, {\n              accept: this.props.accept,\n              onChange: this.onImportExcel,\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"extractButton\",\n                children: this.props.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 34,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 33,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(SortableTable, {\n              data: exceldata,\n              metadata: metadata\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 36,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 32,\n            columnNumber: 21\n          }, this), document.getElementById('root'));\n        } catch (e) {\n          alert(e);\n          return;\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(InputFiles, {\n        accept: this.props.accept,\n        onChange: this.onImportExcel,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"extractButton\",\n          children: this.props.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default InputFile;","map":{"version":3,"sources":["/Users/tim/Documents/React/React_test/src/InputFile.js"],"names":["React","ReactDOM","InputFiles","XLSX","SortableTable","script","InputFile","Component","onImportExcel","files","fileReader","FileReader","index","length","name","onload","event","fileExt","target","RangeError","result","workbook","read","type","excel","concat","utils","sheet_to_json","Sheets","exceldata","getExcel","metadata","getMetadate","render","document","getElementById","props","accept","e","alert","readAsBinaryString"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport * as script from './Script.js';\nimport './index.css';\n\nclass InputFile extends React.Component{\n    onImportExcel = files => {\n        const fileReader = new FileReader();\n        for (let index = 0; index < files.length; index++)\n            fileReader.name = files[index].name;\n        fileReader.onload = event => {\n            try {\n                const fileExt = event.target.name;\n                if (fileExt == null)\n                    throw RangeError(\"檔案為空值\");\n                const { result } = event.target;\n                const workbook = XLSX.read(result, { type: \"binary\" });\n                let excel = [];\n                excel = excel.concat(\n                    XLSX.utils.sheet_to_json(workbook.Sheets['DX'])\n                );\n                var exceldata = script.getExcel(excel);\n                var metadata = script.getMetadate();\n                ReactDOM.render(\n                    <div>\n                    </div>, \n                    document.getElementById('root'));\n                ReactDOM.render(\n                    <div>\n                        <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                            <button className=\"extractButton\">{this.props.name}</button>\n                        </InputFiles>\n                        <SortableTable data={exceldata} metadata={metadata}/>\n                    </div>, \n                    document.getElementById('root'));\n            } catch (e) {\n                alert(e);\n                return;\n            }\n        };\n        fileReader.readAsBinaryString(files[0]);\n    };\n    render(){\n        return (\n            <div>\n                <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                    <button className=\"extractButton\">{this.props.name}</button>\n                </InputFiles>\n            </div>\n        );\n    };\n}\nexport default InputFile;"]},"metadata":{},"sourceType":"module"}