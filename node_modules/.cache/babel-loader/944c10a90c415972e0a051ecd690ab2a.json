{"ast":null,"code":"var _jsxFileName = \"/Users/tim/Documents/RCM_taskManage/src/SortableTable.js\";\nimport React from \"react\";\nimport 'antd/dist/antd.css';\nimport { sortableContainer, sortableElement } from 'react-sortable-hoc';\nimport { Table, Button, Popconfirm } from 'antd';\nimport arrayMove from 'array-move';\nimport { sortableHandle } from 'react-sortable-hoc';\nimport { MenuOutlined } from '@ant-design/icons';\nimport ManuallyEdit from './ManuallyEdit'; //\n\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx'; //import SortableTable from './SortableTable';\n\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SortableItem = sortableElement(_c = props => /*#__PURE__*/_jsxDEV(\"tr\", { ...props\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 17,\n  columnNumber: 47\n}, this));\n_c2 = SortableItem;\nconst SortableContainer = sortableContainer(_c3 = props => /*#__PURE__*/_jsxDEV(\"tbody\", { ...props\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 18,\n  columnNumber: 54\n}, this));\n_c4 = SortableContainer;\nconst DragHandle = sortableHandle(_c5 = () => /*#__PURE__*/_jsxDEV(MenuOutlined, {\n  style: {\n    cursor: 'grab',\n    color: '#999'\n  }\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 19,\n  columnNumber: 41\n}, this));\n_c6 = DragHandle;\n\nclass SortableTable extends React.Component {\n  constructor(_props) {\n    super(_props);\n\n    this.getExcel = excel => {\n      //8碼日期y+m+d\n      let date = new Date();\n      var y = date.getFullYear().toString();\n      var m = (date.getMonth() + 1).toString();\n\n      if (m < 10) {\n        m = \"0\" + m;\n      }\n\n      var d = date.getDate().toString();\n\n      if (d < 10) {\n        d = \"0\" + d;\n      } //欄位資料的建構式\n\n\n      function MachineInfo(index, taskId, produceBatchNo, productModelNo, currentQuantity, machinePosition) {\n        return {\n          index: index,\n          taskId: taskId,\n          produceBatchNo: produceBatchNo,\n          productModelNo: productModelNo,\n          currentQuantity: currentQuantity,\n          machinePosition: machinePosition,\n          key: '',\n          action: '',\n          currentStatus: '未派工',\n          eRackPositionNotTested: '',\n          eRackPositionTested: '',\n          pv: '50'\n        };\n      } //迴圈取資料\n\n\n      var data = [];\n      var i = 0,\n          j,\n          k;\n      var m_index = 0;\n      var m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition;\n\n      for (; excel.length > i; ++i) {\n        if (excel[i].hasOwnProperty('矽格股份有限公司')) {\n          if (excel[i]['矽格股份有限公司'].hasOwnProperty('length')) {\n            if (excel[i]['矽格股份有限公司'].indexOf('DX-') > -1) {\n              m_machinePosition = excel[i]['矽格股份有限公司'];\n\n              for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2'); ++j, ++k) {\n                m_taskId = y + m + d + excel[j].__EMPTY_2;\n                m_produceBatchNo = excel[j].__EMPTY_2;\n                m_productModelNo = excel[j].__EMPTY_4;\n                m_currentQuantity = excel[j].__EMPTY_7;\n                data[m_index] = MachineInfo(m_index, m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition);\n                ++m_index;\n              }\n\n              if (excel[i].hasOwnProperty('__EMPTY_12')) {\n                m_machinePosition = excel[i].__EMPTY_12;\n\n                for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15'); ++j, ++k) {\n                  m_taskId = y + m + d + excel[j].__EMPTY_15;\n                  m_produceBatchNo = excel[j].__EMPTY_15;\n                  m_productModelNo = excel[j].__EMPTY_17;\n                  m_currentQuantity = excel[j].__EMPTY_20;\n                  data[m_index] = MachineInfo(m_index, m_taskId, m_produceBatchNo, m_productModelNo, m_currentQuantity, m_machinePosition);\n                  ++m_index;\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return data;\n    };\n\n    this.onImportExcel = files => {\n      const fileReader = new FileReader();\n\n      for (let index = 0; index < files.length; index++) fileReader.name = files[index].name;\n\n      fileReader.onload = event => {\n        try {\n          const fileExt = event.target.name;\n          if (fileExt == null) throw RangeError(\"檔案為空值\");\n          const {\n            result\n          } = event.target;\n          const workbook = XLSX.read(result, {\n            type: \"binary\"\n          });\n          let excel = [];\n          excel = excel.concat(XLSX.utils.sheet_to_json(workbook.Sheets['DX']));\n          console.log(excel); //array 461筆\n          //\n\n          var exceldata = this.getExcel(excel);\n          console.log(exceldata); //array 300筆\n          //不太正常的地方\n          // ReactDOM.render(\n          //     <div></div>, \n          //     document.getElementById('root'));\n          // ReactDOM.render(\n          //     <div>\n          //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n          //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n          //         </InputFiles>\n          //         <ManuallyCreate name=\"手動新增\" />\n          //         <SortableTable data={exceldata} />\n          //     </div>, \n          //     document.getElementById('root'));\n        } catch (e) {\n          alert(e);\n          return;\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n\n    this.delete = () => {\n      console.log(\"已刪除\");\n    };\n\n    this.onSortEnd = ({\n      oldIndex,\n      newIndex\n    }) => {\n      const {\n        data\n      } = this.state;\n\n      if (oldIndex !== newIndex) {\n        const newData = arrayMove([].concat(data), oldIndex, newIndex).filter(el => !!el);\n        this.setState({\n          data: newData\n        });\n      }\n    };\n\n    this.DraggableContainer = props => /*#__PURE__*/_jsxDEV(SortableContainer, {\n      useDragHandle: true,\n      disableAutoscroll: true,\n      helperClass: \"row-dragging\",\n      onSortEnd: this.onSortEnd,\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 4\n    }, this);\n\n    this.DraggableBodyRow = ({\n      className,\n      style,\n      ...restProps\n    }) => {\n      const {\n        data\n      } = this.state;\n      const index = data.findIndex(x => x.index === restProps['data-row-key']);\n      return /*#__PURE__*/_jsxDEV(SortableItem, {\n        index: index,\n        ...restProps\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 10\n      }, this);\n    };\n\n    this.state = {\n      data: this.props.data\n    };\n  }\n\n  render() {\n    const {\n      data\n    } = this.state;\n    this.columns = [{\n      title: \"拖拉\",\n      dataIndex: \"sort\",\n      className: \"drag-visible\",\n      key: \"sort\",\n      render: () => /*#__PURE__*/_jsxDEV(DragHandle, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 20\n      }, this)\n    }, {\n      title: \"任務編號\",\n      dataIndex: \"taskId\",\n      className: \"drag-visible\",\n      key: \"taskId\"\n    }, {\n      title: \"生產批號\",\n      dataIndex: \"produceBatchNo\",\n      key: \"produceBatchNo\"\n    }, {\n      title: \"產品型號\",\n      dataIndex: \"productModelNo\",\n      key: \"productModelNo\"\n    }, {\n      title: \"現況數量\",\n      dataIndex: \"currentQuantity\",\n      key: \"currentQuantity\"\n    }, {\n      title: \"機台位置\",\n      dataIndex: \"machinePosition\",\n      key: \"machinePosition\"\n    }, {\n      title: \"操作\",\n      dataIndex: \"action\",\n      key: \"action\",\n      render: (text, record, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          className: \"ant-btn\",\n          type: \"button\",\n          children: \"\\u6D3E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Popconfirm, {\n          title: \"\\u78BA\\u5B9A\\u8981\\u522A\\u9664?\",\n          onConfirm: this.delete,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            className: \"ant-btn\",\n            type: \"button\",\n            children: \"\\u522A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(ManuallyEdit, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 5\n      }, this)\n    }, {\n      title: \"派工狀態\",\n      dataIndex: \"currentStatus\",\n      key: \"currentStatus\"\n    }, {\n      title: \"e-Rack櫃位(待測)\",\n      dataIndex: \"eRackPositionNotTested\",\n      key: \"eRackPositionNotTested\"\n    }, {\n      title: \"e-Rack櫃位(已測)\",\n      dataIndex: \"eRackPositionTested\",\n      key: \"eRackPositionTested\"\n    }, {\n      title: \"優先序\",\n      dataIndex: \"pv\",\n      key: \"pv\"\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: /*#__PURE__*/_jsxDEV(InputFiles, {\n          accept: this.props.accept,\n          onChange: this.onImportExcel,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            className: \"extractButton\",\n            type: \"primary\",\n            children: this.props.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        pagination: false //true -> 分頁\n        ,\n        columns: this.columns,\n        dataSource: this.exceldata,\n        rowKey: \"index\",\n        components: {\n          body: {\n            wrapper: this.DraggableContainer,\n            row: this.DraggableBodyRow\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 4\n    }, this);\n  }\n\n}\n\nexport default SortableTable;\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"SortableItem$sortableElement\");\n$RefreshReg$(_c2, \"SortableItem\");\n$RefreshReg$(_c3, \"SortableContainer$sortableContainer\");\n$RefreshReg$(_c4, \"SortableContainer\");\n$RefreshReg$(_c5, \"DragHandle$sortableHandle\");\n$RefreshReg$(_c6, \"DragHandle\");","map":{"version":3,"sources":["/Users/tim/Documents/RCM_taskManage/src/SortableTable.js"],"names":["React","sortableContainer","sortableElement","Table","Button","Popconfirm","arrayMove","sortableHandle","MenuOutlined","ManuallyEdit","ReactDOM","InputFiles","XLSX","ManuallyCreate","SortableItem","props","SortableContainer","DragHandle","cursor","color","SortableTable","Component","constructor","getExcel","excel","date","Date","y","getFullYear","toString","m","getMonth","d","getDate","MachineInfo","index","taskId","produceBatchNo","productModelNo","currentQuantity","machinePosition","key","action","currentStatus","eRackPositionNotTested","eRackPositionTested","pv","data","i","j","k","m_index","m_taskId","m_produceBatchNo","m_productModelNo","m_currentQuantity","m_machinePosition","length","hasOwnProperty","indexOf","__EMPTY_2","__EMPTY_4","__EMPTY_7","__EMPTY_12","__EMPTY_15","__EMPTY_17","__EMPTY_20","onImportExcel","files","fileReader","FileReader","name","onload","event","fileExt","target","RangeError","result","workbook","read","type","concat","utils","sheet_to_json","Sheets","console","log","exceldata","e","alert","readAsBinaryString","delete","onSortEnd","oldIndex","newIndex","state","newData","filter","el","setState","DraggableContainer","DraggableBodyRow","className","style","restProps","findIndex","x","render","columns","title","dataIndex","text","record","accept","body","wrapper","row"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport 'antd/dist/antd.css';\nimport { sortableContainer, sortableElement } from 'react-sortable-hoc';\nimport { Table, Button, Popconfirm } from 'antd';\nimport arrayMove from 'array-move';\nimport { sortableHandle } from 'react-sortable-hoc';\nimport { MenuOutlined } from '@ant-design/icons';\nimport ManuallyEdit from './ManuallyEdit';\n//\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\n//import SortableTable from './SortableTable';\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\n\nconst SortableItem = sortableElement(props => <tr {...props} />);\nconst SortableContainer = sortableContainer(props => <tbody {...props} />);\nconst DragHandle = sortableHandle(() => <MenuOutlined style={{ cursor: 'grab', color: '#999' }} />);\n\nclass SortableTable extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tdata: this.props.data\n\t\t};\n\t}\n\tgetExcel = (excel) => {\n        //8碼日期y+m+d\n\t\tlet date = new Date();\n\t\tvar y = date.getFullYear().toString();\n\t\tvar m = (date.getMonth()+1).toString();\n\t\t\tif(m < 10){\n\t\t\t\tm = \"0\" + m;\n\t\t\t}\n\t\tvar d = date.getDate().toString();\n            if (d < 10){\n                d = \"0\" + d ;\n            }\n        //欄位資料的建構式\n        function MachineInfo(index,taskId,produceBatchNo,productModelNo,currentQuantity,machinePosition){\n            return{\n                index : index,\n                taskId : taskId,\n                produceBatchNo : produceBatchNo,\n                productModelNo : productModelNo,\n                currentQuantity : currentQuantity,\n                machinePosition : machinePosition,\n                key : '',\n                action : '',\n                currentStatus : '未派工',\n                eRackPositionNotTested : '',\n                eRackPositionTested : '',\n                pv : '50'\n            };\n        }\n        //迴圈取資料\n        var data = [];\n\t\tvar i = 0,j,k;\n        var m_index = 0;\n        var m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition;\n\t\tfor(;excel.length > i; ++i){\n\t\t\tif(excel[i].hasOwnProperty('矽格股份有限公司')){\n\t\t\t\tif(excel[i]['矽格股份有限公司'].hasOwnProperty('length')){  \n\t\t\t\t\tif(excel[i]['矽格股份有限公司'].indexOf('DX-') > -1){\n\t\t\t\t\t\tm_machinePosition = excel[i]['矽格股份有限公司'];\n\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2');++j,++k){\n\t\t\t\t\t\t\tm_taskId =  y + m + d + excel[j].__EMPTY_2;\n\t\t\t\t\t\t\tm_produceBatchNo = excel[j].__EMPTY_2;\n\t\t\t\t\t\t\tm_productModelNo = excel[j].__EMPTY_4;\n\t\t\t\t\t\t\tm_currentQuantity = excel[j].__EMPTY_7;\n\t\t\t\t\t\t\tdata[m_index] = MachineInfo(m_index,m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition);\n\t\t\t\t\t\t\t++m_index;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(excel[i].hasOwnProperty('__EMPTY_12')){\n\t\t\t\t\t\t\tm_machinePosition = excel[i].__EMPTY_12;\n\t\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15');++j,++k){\n\t\t\t\t\t\t\t\tm_taskId =  y + m + d + excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\tm_produceBatchNo = excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\tm_productModelNo = excel[j].__EMPTY_17;\n\t\t\t\t\t\t\t\tm_currentQuantity = excel[j].__EMPTY_20;\n\t\t\t\t\t\t\t\tdata[m_index] = MachineInfo(m_index,m_taskId,m_produceBatchNo,m_productModelNo,m_currentQuantity,m_machinePosition);\n\t\t\t\t\t\t\t\t++m_index;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n    onImportExcel = files => {\n        const fileReader = new FileReader();\n        for (let index = 0; index < files.length; index++)\n            fileReader.name = files[index].name;\n        fileReader.onload = event => {\n            try {\n                const fileExt = event.target.name;\n                if (fileExt == null)\n                    throw RangeError(\"檔案為空值\");\n                const { result } = event.target;\n                const workbook = XLSX.read(result, { type: \"binary\" });\n                let excel = [];\n                excel = excel.concat(\n                    XLSX.utils.sheet_to_json(workbook.Sheets['DX'])\n                );\n                console.log(excel); //array 461筆\n                //\n                var exceldata = this.getExcel(excel);\n                console.log(exceldata); //array 300筆\n                //不太正常的地方\n                // ReactDOM.render(\n                //     <div></div>, \n                //     document.getElementById('root'));\n                // ReactDOM.render(\n                //     <div>\n                //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n                //         </InputFiles>\n                //         <ManuallyCreate name=\"手動新增\" />\n                //         <SortableTable data={exceldata} />\n                //     </div>, \n                //     document.getElementById('root'));\n            } catch (e) {\n                alert(e);\n                return;\n            }\n        };\n        fileReader.readAsBinaryString(files[0]);\n    };\n\tdelete = () => {\n\t\tconsole.log(\"已刪除\");\n\t  };\n\tonSortEnd = ({ oldIndex, newIndex }) => {\n\t\tconst { data } = this.state;\n\t  \tif (oldIndex !== newIndex){\n\t\t\tconst newData = arrayMove([].concat(data), oldIndex, newIndex).filter(el => !!el);\n\t\t\tthis.setState({data: newData});\n\t  \t}\n\t}\n\tDraggableContainer = props => (\n\t  <SortableContainer\n\t\tuseDragHandle\n\t\tdisableAutoscroll\n\t\thelperClass=\"row-dragging\"\n\t\tonSortEnd={this.onSortEnd}\n\t\t{...props}\n\t  />\n\t)\n\tDraggableBodyRow = ({ className, style, ...restProps }) => {\n\t\tconst { data } = this.state;\n\t\tconst index = data.findIndex(x => x.index === restProps['data-row-key']);\n\t\treturn <SortableItem index={index} {...restProps} />;\n\t}\n\trender() {\n\t\tconst { data } = this.state;\n\t\tthis.columns = [\n\t\t\t{\n\t\t\t  title: \"拖拉\",\n\t\t\t  dataIndex: \"sort\",\n\t\t\t  className: \"drag-visible\",\n\t\t\t  key: \"sort\",\n\t\t\t  render: () => <DragHandle />\n\t\t\t},\n\t\t\t{\n\t\t\t  title: \"任務編號\",\n\t\t\t  dataIndex: \"taskId\",\n\t\t\t  className: \"drag-visible\",\n\t\t\t  key: \"taskId\"\n\t\t\t},\n\t\t\t{\n\t\t\t  title: \"生產批號\",\n\t\t\t  dataIndex: \"produceBatchNo\",\n\t\t\t  key: \"produceBatchNo\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"產品型號\",\n\t\t\t\tdataIndex: \"productModelNo\",\n\t\t\t\tkey: \"productModelNo\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"現況數量\",\n\t\t\t\tdataIndex: \"currentQuantity\",\n\t\t\t\tkey: \"currentQuantity\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"機台位置\",\n\t\t\t\tdataIndex: \"machinePosition\",\n\t\t\t\tkey: \"machinePosition\"\n\t\t\t},\n\t\t\t{\n\t\t\t  title: \"操作\",\n\t\t\t  dataIndex: \"action\",\n\t\t\t  key: \"action\",\n\t\t\t  render: (text, record, index) => (\n\t\t\t\t<div>\n\t\t\t\t\t<Button\n\t\t\t\t\tclassName=\"ant-btn\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t派\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Popconfirm title=\"確定要刪除?\" onConfirm={this.delete}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"ant-btn\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t刪\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Popconfirm>\n\t\t\t\t\t<ManuallyEdit />\n\t\t\t\t</div>\n\t\t\t  )\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"派工狀態\",\n\t\t\t\tdataIndex: \"currentStatus\",\n\t\t\t\tkey: \"currentStatus\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"e-Rack櫃位(待測)\",\n\t\t\t\tdataIndex: \"eRackPositionNotTested\",\n\t\t\t\tkey: \"eRackPositionNotTested\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"e-Rack櫃位(已測)\",\n\t\t\t\tdataIndex: \"eRackPositionTested\",\n\t\t\t\tkey: \"eRackPositionTested\"\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: \"優先序\",\n\t\t\t\tdataIndex: \"pv\",\n\t\t\t\tkey: \"pv\"\n\t\t\t}\n\t\t  ];\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<span>\n\t\t\t\t\t<InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n\t\t\t\t\t\t<Button className=\"extractButton\" type=\"primary\">\n\t\t\t\t\t\t\t{this.props.name}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</InputFiles>\n\t\t\t\t</span>\n\t\t\t\t<Table\n\t\t\t\t\tpagination={false} //true -> 分頁\n\t\t\t\t\tcolumns={this.columns}\n\t\t\t\t\tdataSource={this.exceldata}\n\t\t\t\t\trowKey=\"index\"\n\t\t\t\t\tcomponents={\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\twrapper: this.DraggableContainer,\n\t\t\t\t\t\t\t\trow: this.DraggableBodyRow,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t};\n}\n\nexport default SortableTable"]},"metadata":{},"sourceType":"module"}