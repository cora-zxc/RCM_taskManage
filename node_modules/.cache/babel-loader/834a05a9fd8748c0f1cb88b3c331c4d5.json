{"ast":null,"code":"var _jsxFileName = \"/Users/tim/Documents/React/React_test/src/InputFile.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass InputFile extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.getExcel = excel => {\n      class MachineInfo {\n        constructor(index, taskId, produceBatchNo, productModelNo, currentQuantity, machinePosition) {\n          this.key = '';\n          this.action = '';\n          this.currentStatus = '未派工';\n          this.eRackPositionNotTested = '';\n          this.eRackPositionTested = '';\n          this.pv = '50';\n          this.index = index;\n          this.taskId = taskId;\n          this.produceBatchNo = produceBatchNo;\n          this.productModelNo = productModelNo;\n          this.currentQuantity = currentQuantity;\n          this.machinePosition = machinePosition;\n        }\n\n      }\n\n      var data = [];\n      let date = new Date();\n      var y = date.getFullYear().toString();\n      var m = (date.getMonth() + 1).toString();\n\n      if (date.getMonth() + 1 < 10) {\n        m = \"0\" + m;\n      }\n\n      var d = date.getDate().toString();\n      var i = 0,\n          j,\n          k,\n          count = 0,\n          task_id,\n          batchNo,\n          type,\n          num,\n          machine_position;\n\n      for (; excel.length > i; ++i) {\n        if (excel[i].hasOwnProperty('矽格股份有限公司')) {\n          if (excel[i]['矽格股份有限公司'].hasOwnProperty('length')) {\n            if (excel[i]['矽格股份有限公司'].indexOf('DX-') > -1) {\n              machine_position = excel[i]['矽格股份有限公司'];\n\n              for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2'); ++j, ++k) {\n                task_id = y + m + d + excel[j].__EMPTY_2;\n                batchNo = excel[j].__EMPTY_2;\n                type = excel[j].__EMPTY_4;\n                num = excel[j].__EMPTY_7;\n                data[count] = new MachineInfo(count, task_id, batchNo, type, num, machine_position);\n                ++count;\n              }\n\n              if (excel[i].hasOwnProperty('__EMPTY_12')) {\n                machine_position = excel[i].__EMPTY_12;\n\n                for (j = i + 2, k = 0; 4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15'); ++j, ++k) {\n                  task_id = y + m + d + excel[j].__EMPTY_15;\n                  batchNo = excel[j].__EMPTY_15;\n                  type = excel[j].__EMPTY_17;\n                  num = excel[j].__EMPTY_20;\n                  data[count] = new MachineInfo(count, task_id, batchNo, type, num, machine_position);\n                  ++count;\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return data;\n    };\n\n    this.onImportExcel = files => {\n      const fileReader = new FileReader();\n\n      for (let index = 0; index < files.length; index++) fileReader.name = files[index].name;\n\n      fileReader.onload = event => {\n        try {\n          const fileExt = event.target.name;\n          if (fileExt == null) throw RangeError(\"檔案為空值\");\n          const {\n            result\n          } = event.target;\n          const workbook = XLSX.read(result, {\n            type: \"binary\"\n          });\n          let excel = [];\n          excel = excel.concat(XLSX.utils.sheet_to_json(workbook.Sheets['DX']));\n          console.log(excel); //array 461筆\n          //\n\n          var exceldata = this.getExcel(excel);\n          console.log(exceldata); //array 300筆\n\n          /*#__PURE__*/\n          _jsxDEV(SortableTable, {\n            data: exceldata\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 17\n          }, this); // ReactDOM.render(\n          //     <div></div>, \n          //     document.getElementById('root'));\n          // ReactDOM.render(\n          //     <div>\n          //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n          //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n          //         </InputFiles>\n          //         <ManuallyCreate name=\"手動新增\" />\n          //         <SortableTable data={exceldata} />\n          //     </div>, \n          //     document.getElementById('root'));\n\n        } catch (e) {\n          alert(e);\n          return;\n        }\n      };\n\n      fileReader.readAsBinaryString(files[0]);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      children: /*#__PURE__*/_jsxDEV(InputFiles, {\n        accept: this.props.accept,\n        onChange: this.onImportExcel,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          className: \"extractButton\",\n          type: \"primary\",\n          children: this.props.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default InputFile;","map":{"version":3,"sources":["/Users/tim/Documents/React/React_test/src/InputFile.js"],"names":["React","ReactDOM","InputFiles","XLSX","SortableTable","ManuallyCreate","Button","InputFile","Component","getExcel","excel","MachineInfo","constructor","index","taskId","produceBatchNo","productModelNo","currentQuantity","machinePosition","key","action","currentStatus","eRackPositionNotTested","eRackPositionTested","pv","data","date","Date","y","getFullYear","toString","m","getMonth","d","getDate","i","j","k","count","task_id","batchNo","type","num","machine_position","length","hasOwnProperty","indexOf","__EMPTY_2","__EMPTY_4","__EMPTY_7","__EMPTY_12","__EMPTY_15","__EMPTY_17","__EMPTY_20","onImportExcel","files","fileReader","FileReader","name","onload","event","fileExt","target","RangeError","result","workbook","read","concat","utils","sheet_to_json","Sheets","console","log","exceldata","e","alert","readAsBinaryString","render","props","accept"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport InputFiles from 'react-input-files';\nimport XLSX from 'xlsx';\nimport SortableTable from './SortableTable';\nimport './index.css';\nimport ManuallyCreate from './ManuallyCreate';\nimport { Button } from 'antd';\n\n\nclass InputFile extends React.Component{\n    getExcel = (excel) => {\n        class MachineInfo{\n            constructor(index,taskId,produceBatchNo,productModelNo,currentQuantity,machinePosition){\n              this.index = index;\n              this.taskId = taskId;\n              this.produceBatchNo = produceBatchNo;\n              this.productModelNo = productModelNo;\n              this.currentQuantity = currentQuantity;\n              this.machinePosition = machinePosition;\n            }\n            key = '';\n            action = '';\n            currentStatus = '未派工';\n            eRackPositionNotTested = '';\n            eRackPositionTested = '';\n            pv= '50';\n        }\n\t\tvar data = [];\n\t\tlet date = new Date();\n\t\tvar y = date.getFullYear().toString();\n\t\tvar m = (date.getMonth()+1).toString();\n\t\t\tif( date.getMonth()+1 <10){\n\t\t\t\tm = \"0\" + m;\n\t\t\t}\n\t\tvar d = date.getDate().toString();\n\t\tvar i = 0,j,k,count = 0,task_id,batchNo,type,num,machine_position;\n\t\tfor(;excel.length > i; ++i){\n\t\t\tif(excel[i].hasOwnProperty('矽格股份有限公司')){\n\t\t\t\tif(excel[i]['矽格股份有限公司'].hasOwnProperty('length')){  \n\t\t\t\t\tif(excel[i]['矽格股份有限公司'].indexOf('DX-') > -1){\n\t\t\t\t\t\tmachine_position = excel[i]['矽格股份有限公司'];\n\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_2');++j,++k){\n\t\t\t\t\t\t\ttask_id =  y + m + d + excel[j].__EMPTY_2;\n\t\t\t\t\t\t\tbatchNo = excel[j].__EMPTY_2;\n\t\t\t\t\t\t\ttype = excel[j].__EMPTY_4;\n\t\t\t\t\t\t\tnum = excel[j].__EMPTY_7;\n\t\t\t\t\t\t\tdata[count] = new MachineInfo(count,task_id,batchNo,type,num,machine_position);\n\t\t\t\t\t\t\t++count;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(excel[i].hasOwnProperty('__EMPTY_12')){\n\t\t\t\t\t\t\tmachine_position = excel[i].__EMPTY_12;\n\t\t\t\t\t\t\tfor(j = i + 2,k = 0;4 > k && excel.length > j && excel[j].hasOwnProperty('__EMPTY_15');++j,++k){\n\t\t\t\t\t\t\t\ttask_id =  y + m + d + excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\tbatchNo = excel[j].__EMPTY_15;\n\t\t\t\t\t\t\t\ttype = excel[j].__EMPTY_17;\n\t\t\t\t\t\t\t\tnum = excel[j].__EMPTY_20;\n\t\t\t\t\t\t\t\tdata[count] = new MachineInfo(count,task_id,batchNo,type,num,machine_position);\n\t\t\t\t\t\t\t\t++count;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n    onImportExcel = files => {\n        const fileReader = new FileReader();\n        for (let index = 0; index < files.length; index++)\n            fileReader.name = files[index].name;\n        fileReader.onload = event => {\n            try {\n                const fileExt = event.target.name;\n                if (fileExt == null)\n                    throw RangeError(\"檔案為空值\");\n                const { result } = event.target;\n                const workbook = XLSX.read(result, { type: \"binary\" });\n                let excel = [];\n                excel = excel.concat(\n                    XLSX.utils.sheet_to_json(workbook.Sheets['DX'])\n                );\n                console.log(excel); //array 461筆\n                //\n                var exceldata = this.getExcel(excel);\n                console.log(exceldata); //array 300筆\n                <SortableTable data={exceldata} />\n                // ReactDOM.render(\n                //     <div></div>, \n                //     document.getElementById('root'));\n                // ReactDOM.render(\n                //     <div>\n                //         <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                //             <Button className=\"extractButton\" type=\"primary\">{this.props.name}</Button>\n                //         </InputFiles>\n                //         <ManuallyCreate name=\"手動新增\" />\n                //         <SortableTable data={exceldata} />\n                //     </div>, \n                //     document.getElementById('root'));\n            } catch (e) {\n                alert(e);\n                return;\n            }\n        };\n        fileReader.readAsBinaryString(files[0]);\n    };\n    render(){\n        return (\n            <span>\n                <InputFiles accept={this.props.accept} onChange={this.onImportExcel}>\n                    <Button className=\"extractButton\" type=\"primary\">\n                        {this.props.name}\n                    </Button>\n                </InputFiles>\n            </span>\n        );\n    };\n}\nexport default InputFile;"]},"metadata":{},"sourceType":"module"}